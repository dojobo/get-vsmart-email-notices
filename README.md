This small project (my first github repo!) simply finds and gets the email notice text files generated by the Vsmart ILS for a given date, and reports how many notices were generated for each category (overdue notice, reservation pickup notice, invoice notice). This is very simple functionality, but a very important bit of automation if you need to confirm that notices were indeed generated as they were supposed to have been.

The counting script (countnotices.py) is separate, and written in Python, because I found that Ruby had trouble with Windows file permissions.

The counting script also writes to a MS-SQL database. This provides a permanent record of the counts as well as email (using SQL Server's DB Mail) based on an INSERT trigger. TSQL scripts are in the /scripts/ folder for creating the table, triggers, stored procedures, and SQL Server Agent job. 

USAGE: `getnotices.rb yyyy-mm-dd [yyyy-mm-dd]...`
Just put in the date you want as a command-line argument. You can get multiple dates at once. Putting no date will default to today's.

Credentials are separated into credentials.yml. This should be in your .gitignore file. Use credentials-template.yml file and rename it as credentials.yml.